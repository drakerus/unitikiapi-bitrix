!function(c){var h=function(a,b){b.scrollBar&&(b.items=100,b.menu='<ul class="typeahead dropdown-menu" style="max-height:220px;overflow:auto;"></ul>');this.$element=c(a);this.options=c.extend({},c.fn.typeahead.defaults,b);this.$menu=c(this.options.menu).insertAfter(this.$element);this.eventSupported=this.options.eventSupported||this.eventSupported;this.grepper=this.options.grepper||this.grepper;this.highlighter=this.options.highlighter||this.highlighter;this.lookup=this.options.lookup||this.lookup;
this.matcher=this.options.matcher||this.matcher;this.render=this.options.render||this.render;this.onSelect=this.options.onSelect||null;this.sorter=this.options.sorter||this.sorter;this.source=this.options.source||this.source;this.displayField=this.options.displayField||this.displayField;this.valueField=this.options.valueField||this.valueField;if(this.options.ajax){var d=this.options.ajax;"string"===typeof d?this.ajax=c.extend({},c.fn.typeahead.defaults.ajax,{url:d}):("string"===typeof d.displayField&&
(this.displayField=this.options.displayField=d.displayField),"string"===typeof d.valueField&&(this.valueField=this.options.valueField=d.valueField),this.ajax=c.extend({},c.fn.typeahead.defaults.ajax,d));this.ajax.url||(this.ajax=null);this.query=""}else this.source=this.options.source,this.ajax=null;this.shown=!1;this.listen()};h.prototype={constructor:h,eventSupported:function(a){var b=a in this.$element;b||(this.$element.setAttribute(a,"return;"),b="function"===typeof this.$element[a]);return b},
select:function(){var a=this.$menu.find(".active").attr("data-value"),b=this.$menu.find(".active a").text();if(this.options.onSelect)this.options.onSelect({value:a,text:b});this.$element.val(this.updater(b)).change();return this.hide()},updater:function(a){return a},show:function(){var a=c.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});this.$menu.css({top:a.top+a.height,left:a.left});this.options.alignWidth&&(a=c(this.$element[0]).outerWidth(),this.$menu.css({width:a}));
this.$menu.show();this.shown=!0;return this},hide:function(){this.$menu.hide();this.shown=!1;return this},ajaxLookup:function(){var a=c.trim(this.$element.val());if(a===this.query)return this;this.query=a;this.ajax.timerId&&(clearTimeout(this.ajax.timerId),this.ajax.timerId=null);if(!a||a.length<this.ajax.triggerLength)return this.ajax.xhr&&(this.ajax.xhr.abort(),this.ajax.xhr=null,this.ajaxToggleLoadClass(!1)),this.shown?this.hide():this;this.ajax.timerId=setTimeout(c.proxy(function(){this.ajaxToggleLoadClass(!0);
this.ajax.xhr&&this.ajax.xhr.abort();var b=this.ajax.preDispatch?this.ajax.preDispatch(a):{query:a};this.ajax.xhr=c.ajax({url:this.ajax.url,data:b,success:c.proxy(this.ajaxSource,this),type:this.ajax.method||"get",dataType:"json"});this.ajax.timerId=null},this),this.ajax.timeout);return this},ajaxSource:function(a){this.ajaxToggleLoadClass(!1);if(this.ajax.xhr){this.ajax.preProcess&&(a=this.ajax.preProcess(a));this.ajax.data=a;a=this.grepper(this.ajax.data)||[];if(!a.length)return this.shown?this.hide():
this;this.ajax.xhr=null;return this.render(a.slice(0,this.options.items)).show()}},ajaxToggleLoadClass:function(a){this.ajax.loadingClass&&this.$element.toggleClass(this.ajax.loadingClass,a)},lookup:function(a){if(this.ajax)this.ajaxer();else{this.query=this.$element.val();if(!this.query)return this.shown?this.hide():this;a=this.grepper(this.source);if(!a)return this.shown?this.hide():this;0==a.length&&(a[0]={id:-21,name:"Result not Found"});return this.render(a.slice(0,this.options.items)).show()}},
matcher:function(a){return~a.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(a){if(this.options.ajax)return a;for(var b=[],c=[],e=[],f;f=a.shift();)f.toLowerCase().indexOf(this.query.toLowerCase())?~f.indexOf(this.query)?c.push(f):e.push(f):b.push(f);return b.concat(c,e)},highlighter:function(a){var b=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return a.replace(new RegExp("("+b+")","ig"),function(a,b){return"<strong>"+b+"</strong>"})},render:function(a){var b=this,d,
e="string"===typeof b.options.displayField;a=c(a).map(function(a,g){"object"===typeof g?(d=e?g[b.options.displayField]:b.options.displayField(g),a=c(b.options.item).attr("data-value",g[b.options.valueField])):(d=g,a=c(b.options.item).attr("data-value",g));a.find("a").html(b.highlighter(d));return a[0]});a.first().addClass("active");this.$menu.html(a);return this},grepper:function(a){var b=this,d,e="string"===typeof b.options.displayField;if(e&&a&&a.length)if(a[0].hasOwnProperty(b.options.displayField))a=
c.grep(a,function(a){d=e?a[b.options.displayField]:b.options.displayField(a);return b.matcher(d)});else if("string"===typeof a[0])a=c.grep(a,function(a){return b.matcher(a)});else return null;else return null;return this.sorter(a)},next:function(a){a=this.$menu.find(".active").removeClass("active").next();a.length||(a=c(this.$menu.find("li")[0]));if(this.options.scrollBar){var b=this.$menu.children("li").index(a);0==b%8&&this.$menu.scrollTop(26*b)}a.addClass("active")},prev:function(a){a=this.$menu.find(".active").removeClass("active").prev();
a.length||(a=this.$menu.find("li").last());if(this.options.scrollBar){var b=this.$menu.children("li"),c=b.length-1,b=b.index(a);0==(c-b)%8&&this.$menu.scrollTop(26*(b-7))}a.addClass("active")},listen:function(){this.$element.on("focus",c.proxy(this.focus,this)).on("blur",c.proxy(this.blur,this)).on("keypress",c.proxy(this.keypress,this)).on("keyup",c.proxy(this.keyup,this));if(this.eventSupported("keydown"))this.$element.on("keydown",c.proxy(this.keydown,this));this.$menu.on("click",c.proxy(this.click,
this)).on("mouseenter","li",c.proxy(this.mouseenter,this)).on("mouseleave","li",c.proxy(this.mouseleave,this))},move:function(a){if(this.shown){switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:a.preventDefault();this.prev();break;case 40:a.preventDefault(),this.next()}a.stopPropagation()}},keydown:function(a){this.suppressKeyPressRepeat=~c.inArray(a.keyCode,[40,38,9,13,27]);this.move(a)},keypress:function(a){this.suppressKeyPressRepeat||this.move(a)},keyup:function(a){switch(a.keyCode){case 40:case 38:case 16:case 17:case 18:break;
case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.ajax?this.ajaxLookup():this.lookup()}a.stopPropagation();a.preventDefault()},focus:function(a){this.focused=!0},blur:function(a){this.focused=!1;!this.mousedover&&this.shown&&this.hide()},click:function(a){a.stopPropagation();a.preventDefault();this.select();this.$element.focus()},mouseenter:function(a){this.mousedover=!0;this.$menu.find(".active").removeClass("active");c(a.currentTarget).addClass("active")},
mouseleave:function(a){this.mousedover=!1;!this.focused&&this.shown&&this.hide()},destroy:function(){this.$element.off("focus",c.proxy(this.focus,this)).off("blur",c.proxy(this.blur,this)).off("keypress",c.proxy(this.keypress,this)).off("keyup",c.proxy(this.keyup,this));this.eventSupported("keydown")&&this.$element.off("keydown",c.proxy(this.keydown,this));this.$menu.off("click",c.proxy(this.click,this)).off("mouseenter","li",c.proxy(this.mouseenter,this)).off("mouseleave","li",c.proxy(this.mouseleave,
this));this.$element.removeData("typeahead")}};c.fn.typeahead=function(a){return this.each(function(){var b=c(this),d=b.data("typeahead"),e="object"===typeof a&&a;d||b.data("typeahead",d=new h(this,e));if("string"===typeof a)d[a]()})};c.fn.typeahead.defaults={source:[],items:10,scrollBar:!1,alignWidth:!0,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',valueField:"id",displayField:"name",onSelect:function(){},ajax:{url:null,timeout:300,method:"get",triggerLength:1,
loadingClass:null,preDispatch:null,preProcess:null}};c.fn.typeahead.Constructor=h;c(function(){c("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(a){var b=c(this);b.data("typeahead")||(a.preventDefault(),b.typeahead(b.data()))})})}(window.jQuery);